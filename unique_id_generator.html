<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Unique ID Generator</title>
</head>
<body style="background:#0f172a;color:#e2e8f0;text-align:center;padding-top:50px;">
  <h3>Unique ID Generator</h3>

  <script>
    // Step 1: Get or create the unique ID
    let id = localStorage.getItem('unique_id');
    if (!id) {
      id = crypto.randomUUID(); // create new one if not exist
      localStorage.setItem('unique_id', id);
    }

    // Step 2: Listen for messages from parent (index.html or other pages)
    window.addEventListener('message', (event) => {
      // ✅ Original feature: send ID when requested
      if (event.data && event.data.action === 'get_unique_id') {
        event.source.postMessage({ unique_id: id }, '*');
      }

      // ✅ NEW ADDITION:
      // If message comes with "unique_id" (from premim_content_my_subscription_displaying_videos.html)
      // and we already have one stored, send the stored one back
      if (event.data && event.data.unique_id) {
        const storedId = localStorage.getItem('unique_id');
        if (storedId) {
          event.source.postMessage({ unique_id: storedId }, '*');
        }
      }
    });
  </script>
</body>
</html>
